

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Implementation &mdash; Vargi Bots 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pkg_ros_iot_bridge" href="modules.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Vargi Bots
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pkg_ros_iot_bridge</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#pkg-task5">pkg_task5</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Vargi Bots</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Implementation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/rst/implement.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h1>
<p>We are using 5 nodes including node_action_server_ros_iot_bridge.</p>
<p><em>Getting Orders</em>:</p>
<p>Orders are being published in the mqtt topic <strong>“/eyrc/vb/axaKcGsN/orders”</strong>. ROS-IoT Bridge Action Server subscribes to that topic and receives the message.
The orders are then published on the topic <strong>“/ros_iot_bridge/mqtt/sub”</strong>  and a list of all orders is also prepared in this node. The node <strong>“ur5_action_client”</strong> which acts as the action client, subscribes to the topic <strong>“/ros_iot_bridge/mqtt/sub”</strong>.</p>
<p><em>Inventory</em>:</p>
<p>The ur5_action_client takes picture from the 2d camera using openCV. The picture is sliced and the colour of the box is detected by reading the qr code using pyzbar librairy. The colours are stored in a list serially. The inventory is sent to the ROS-IoT Bridge as a goal, which is published to the google sheet’s Inventory sheet using http requests.</p>
<p>The callback function which subscribes to the topic <strong>“/ros_iot_bridge/mqtt/sub”</strong> checks if the box of required colour is present in the inventory or not. If the required box is present, its colour, position on the shelf and the order id is published to the topic <strong>“/arm_commander”</strong>, else it prints the message that inventory is empty.</p>
<p><em>Dispatching</em>:</p>
<p>The topic <strong>“/arm_commander”</strong> is subscribed by the node <strong>“ur5_1_controller”</strong>. This node <strong>“ur5_1_controller”</strong> controls the <strong>ur5_1</strong> arm. When a message is received on the <strong>“/arm_commander”</strong> topic, it is stored in a tuple(tup_order) in which the orders are sorted according to priority. The arm picks up that box, that is on the first index of tup_order and places it on the conveyor belt. After dispatching the box, the first element of tup_order is deleted and its order id and the message dispatched is publlished on the topic <strong>“/order_status”</strong>. The order id and the box’s colour is also published on the topic <strong>“/order_shipping”</strong>.</p>
<p><em>Conveyor</em>:</p>
<p>The node <strong>“convey”</strong> controls the conveyor. It starts the conveyor at full speed. When the dispatched box comes under the logical_camera, it stops the conveyor, publishes a messag on the topic <strong>“/check_box”</strong>, which contains the serial no. of dispatched box and the word True. After the box is picked by the ur5_2 arm, it starts the conveyor again.</p>
<p><em>Shipping</em>:</p>
<p>The node <strong>“ur5_2_controller”</strong> controls the <strong>ur5_2</strong> arm. It subscribes to the topics <strong>“/check_box”</strong> and <strong>“/order_shipping”</strong>. When it gets a message from the topic <strong>“/check_box”</strong>, the arm picks up the box and drops it to a bin, whose colour is received from the topic <strong>“/order_shipping”</strong>. After the box is dropped in its bin, it publishes the order id and the message shipped on the topic <strong>“/order_status”</strong>.</p>
<p><em>Publishing in google sheets</em>:</p>
<p>The action client <strong>ur5_action_client</strong>, subscribes to the topic <strong>“/order_status”</strong>. When it receives a dispatched or shipped message it sends the order id to the ROS-IoT Bridge as a goal through their corresponding goal modes.</p>
<p>After the ROS-IoT Bridge receives goals, it searches the order having the order id that is sent as goal. Then it publishes the details of the order that is dispatched or shipped to its corresponding google sheet using http requests.</p>
<p>The Dashboard gets data from the other sheets using google sheet functions. Emails are sent whenever the package is dispatched or shipped using google apps script taking data from the Dashboard.</p>
<div class="figure align-center" id="id1">
<img alt="../_images/rqt.png" src="../_images/rqt.png" />
<p class="caption"><span class="caption-text"><em>rqt_graph</em></span></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-right" title="pkg_ros_iot_bridge" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, vb_1844.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>